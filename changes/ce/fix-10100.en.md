Fix channel crash for slow clients with enhanced authentication.
Previously, when the client was using enhanced authentication, but the Auth message was sent slowly or the Auth message was lost, the client process would crash.
